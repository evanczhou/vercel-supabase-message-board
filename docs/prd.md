# Product Requirements Document (PRD)

## Project Title

**Supabase Message Board**

## 1 — Executive Summary

A minimal real‑time message board web application built with **Next.js**, **Supabase**, and deployed on **Vercel**.  The goal is to demonstrate the core Supabase stack (database, auth, and realtime) in the simplest possible app so new engineers can spin up, deploy, and iterate quickly.

## 2 — Goals & Non‑Goals

|    | Goals                                              | Non‑Goals                                        |
| -- | -------------------------------------------------- | ------------------------------------------------ |
| 🟢 | Onboard engineers to Supabase & Vercel in < 30 min | Provide a fully‑featured forum or social network |
| 🟢 | Showcase basic CRUD + realtime subscriptions       | Advanced moderation tools (edit/delete)          |
| 🟢 | 100 % public open‑source example                   | Robust auth flows (OAuth)                        |
| 🟢 | Zero‑config CI/CD via Vercel                       | Native mobile apps                               |

## 3 — Personas

* **New Dev** – Wants a working example to learn Supabase quickly.
* **Hobbyist** – Wants to deploy a toy app to share with friends.
* **Tech Lead** – Evaluating Supabase as a backend option.

## 4 — Success Metrics

* **Time‑to‑Hello‑World < 30 min** from `git clone` to live URL.
* **< 200 ms** P95 read latency from Vercel edge to Supabase.
* **Realtime lag < 3 s** for message broadcast to all clients.
* **100 % test pass** in automated CI.

## 5 — User Stories

1. *As a visitor*, I can type my **name** and **message**, press **Send**, and immediately see my message in the list.
2. *As a visitor on another device*, I see the new message appear in real time.
3. *As a developer*, I can run `npm run dev` and see the app locally.
4. *As a reviewer*, I can open the PR preview on Vercel.

## 6 — Functional Requirements

|  FR  | Description                                                  |
| ---- | ------------------------------------------------------------ |
| FR‑1 | Frontend form with inputs: `name`, `content`, `Send` button  |
| FR‑2 | Create record in `messages` table via Supabase JS client     |
| FR‑3 | List messages ordered by `created_at` desc                   |
| FR‑4 | Subscribe to `INSERT` events for realtime updates            |
| FR‑5 | Simple client‑side validation (non‑empty fields ≤ 280 chars) |

## 7 — Non‑Functional Requirements

* **Performance**: P95 initial page load ≤ 1.5 s on 3G network.
* **Security**: RLS enabled; only `insert` & `select` allowed.
* **Scalability**: Up to 500 concurrent websocket connections on free tier.
* **Accessibility**: WCAG 2.1 AA color contrast & semantic HTML.
* **i18n**: Strings externalised for future localization.

## 8 — System Architecture

```
┌────────┐   HTTPS   ┌─────────────────────┐  PostgREST  ┌───────────┐
| Browser|──────────▶| Vercel Edge/Next.js |────────────▶| Supabase  |
└────────┘           └─────────────────────┘             |  DB + RT  |
        ▲  Realtime        ▲    env vars                 └───────────┘
        └──────────────────┘
```

*Vercel preview deployments per branch; Supabase project in `org-dev`.*

## 9 — Data Model

```sql
CREATE TABLE messages (
  id         BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name       TEXT    NOT NULL,
  content    TEXT    NOT NULL CHECK (char_length(content) <= 280),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
);

ALTER TABLE messages ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Public read"  ON messages FOR SELECT USING (true);
CREATE POLICY "Public write" ON messages FOR INSERT WITH CHECK (true);
```

## 10 — API Endpoints (via Supabase Client)

| Action         | Method                                   | Path               | Notes         |
| -------------- | ---------------------------------------- | ------------------ | ------------- |
| List messages  | `select()`                               | `from('messages')` | Ordered desc  |
| Insert message | `insert([{…}])`                          | `from('messages')` | Anon key only |
| Realtime sub   | `supabase.from('messages').on('INSERT')` | WebSocket          | None          |

## 11 — Security & Privacy

* No PII beyond self‑entered `name` & `content`.
* Anon public key only; service role key NEVER shipped to client.
* Harden Supabase → **password rotated quarterly**.

## 12 — UX/UI Guidelines

* Tailwind CSS for rapid styling.
* Mobile‑first responsive layout.
* Toast confirmation on successful send.
* Optimistic UI: append message locally before network round‑trip.

## 13 — Localization

* Extract UI strings to `/src/locales/en.json`.
* Default language: English; placeholders for `ja`, `es`.

## 14 — Analytics & Logging

* Log page views via Vercel Web Analytics (free tier).
* Console warnings surfaced to Sentry in future enhancement.

## 15 — Compliance

* GPL‑3.0 license by default; ok to change before OSS release.

## 16 — Milestones & Timeline

|  Week  | Deliverable                           |
| ------ | ------------------------------------- |
|  0     | Kick‑off, Repo scaffold               |
|  1     | Supabase schema + RLS live            |
|  1     | Next.js pages + components            |
|  2     | Realtime subscription + optimistic UI |
|  2     | CI + Vercel preview, README draft     |
|  3     | Accessibility & i18n pass             |
|  3     | Docs polish, public launch            |

## 17 — Risks & Mitigations

| Risk                              | Likelihood | Impact | Mitigation                            |
| --------------------------------- | ---------- | ------ | ------------------------------------- |
| Supabase free tier limits reached | Low        | Med    | Upgrade to "Pro" or rate‑limit writes |
| Abuse / spam messages             | Med        | Low    | Add captcha or require auth in v1.1   |

## 18 — Future Enhancements

* Supabase Auth w/ GitHub OAuth.
* Edit & Delete (soft‑delete) actions.
* Emoji reactions.
* Pagination / infinite scroll.

---

# 📄 Additional Docs

## README.md (skeleton)

````markdown
# Supabase Message Board

A dead‑simple realtime message board built with Next.js 14, Supabase, and deployed on Vercel.

## Getting Started
```bash
cp .env.example .env.local
npm install
npm run dev
````

Open [http://localhost:3000](http://localhost:3000).

````

## .cursorrules (starter)
```json
{
  "style": "prettier",
  "languages": ["javascript", "typescript", "sql"],
  "testCommand": "npm test",
  "yoloMode": true
}
````

---

*Document version 1.0 – May 25, 2025*
